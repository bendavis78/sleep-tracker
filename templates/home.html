{% extends "base.html" %}
{% block extracss %}
{{ super() }}
<style>
.unlogged-events a {
  cursor: pointer;
}
.unlogged-events a:hover {
  text-decoration: underline;
}
</style>
{% endblock %}

{% block content %}
{% if unloggedDays|length %}
<div class="row">
  <ul class="col l6 offset-l3 m8 offset-m2 s12 collection with-header unlogged-events">
    <li class="collection-header"><h5>Unlogged Nights</h5></li>
    {% for day in unloggedDays %}
    <li class="collection-item">
      {{ day.date|date("dddd,  MMMM D, YYYY") }}
      <a class="secondary-content" data-first-event="{{ day.firstEvent }}" data-last-event="{{ day.lastEvent }}">
        Create Entry
      </a>
    </li>
    {% endfor %}
  </ul>
</div>
{% endif %}
<form method="post" action="{{ url("entries") }}" id="actionForm">
  <input type="hidden" name="action" value="createFromEvent">
  <input type="hidden" name="firstEvent">
  <input type="hidden" name="lastEvent">
</form>
{% endblock %}

{% block extrajs %}
{{ super() }}
<script>
  document.querySelectorAll('.unlogged-events .collection-item a').forEach(function(event) {
    event.addEventListener('click', function() {
      var form = document.getElementById('actionForm');
      var firstEvent = form.querySelector('[name="firstEvent"]');
      var lastEvent = form.querySelector('[name="lastEvent"]');
      firstEvent.value = this.dataset.firstEvent;
      lastEvent.value = this.dataset.lastEvent;
      form.submit();
    });
  });
</script>
{% endblock %}
